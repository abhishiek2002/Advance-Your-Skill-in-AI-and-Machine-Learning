Writing the multilayer perceptron class
- [Instructor] So it turns out that the network we just described is a multilayer perceptron. Think about it. It's made of perceptrons, they are interconnected in a feed forward fashion, and they are organized in layers. This is the input layer. Remember, no neurons, just the inputs. This is the hidden layer with two neurons and this is the output layer with just one neuron. So it's time to start writing code again. So here's our first implementation of the MultiLayerPerceptron class. I'll write the constructor and you'll write the rest. In the constructor, starting at line 36, I'm receiving a parameter called layers, which is a Python list of integers, which represent the number of neurons per layer. This includes the input layer, which has no neurons but here we mean the number of inputs. The other parameter is the bias with a default value of one. Now let me show you the data members of the class, starting at line 38. The layers list becomes the layers NumPy array with exactly the same data as the parameter. The bias is also a member. Now in line 40, we have the actual network. It will be a NumPy array of NumPy arrays at the end but for the moment, I'll use a list of lists, mostly because I'll create arrays of arrays of different sizes. And lastly, we'll need another array with the same dimensions as the network to hold the output values of the neurons. This will be useful for propagating the results through the network. The next part is where I'll write some code. It consists of two nested loops to create the neurons layer by layer. The outer loop iterates on i for each layer. So for each layer, we need to have a list of values and a list of neurons. The new list of values will be filled with zeros for every neuron in the layer. Now the inner loop iterates on J for each neuron in the layer but we'll leave the first layer empty because it has no neurons. So for every neuron, I'll create a perceptron with as many inputs as the neurons in the previous layer. Not counting the bias input here. And I also pass the bias value to the perceptron. And the last two lines turn our newly created lists into NumPy arrays.