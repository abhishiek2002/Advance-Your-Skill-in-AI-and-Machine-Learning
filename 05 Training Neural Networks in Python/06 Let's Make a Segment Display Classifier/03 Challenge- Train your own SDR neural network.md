Challenge: Train your own SDR neural network
(upbeat music) - [Instructor] We have come to our final challenge. It's time to train the segment display recognition neural network you designed. So here's what you have to do in this challenge. Create the neural network you just designed. Train it either using the provided datasets or your own. Now, my dataset is the very minimum. We'll simple train the network with the 10 ideal patterns. So you may add your own patterns if you want. Train the network for a large number of epochs. Something between 1,000 and 3,000 epochs will do the trick. Just like the XOR training challenge, we will not use the validation or test phases. Finally, test the neural network with your own samples. Do this in the text terminal to keep it quick and simple. Now, after I show you the text-based solution for this challenge, I will show you three separate applications that implement the three neural networks we saw earlier using sliders, buttons and other GUI controls. And you'll have the chance to use your neural network in these demos if you'd like. So remember, you are only expected to test your neural network in the terminal. That said, if you would still like to make your own GUI, please feel free to do so. So as usual, I have prepared some testing code at the bottom. Here you should be ready to write your own code but I have provided the very minimum training set for the three models I showed you in case you decided to implement one of them. Be aware that these code snippets aren't functional on their own. So you'll have to write the missing code if you want to use them. If not, feel free to delete them from this file. So starting at line 124, we have a piece of code you may use to train the seven to one neural network. Notice that the patterns in the input are entered with zeros and ones. Pick a moment to read these lines and verify that each sample corresponds to the number in the comment at the right. So for the labels, notice that I'm assigning each pattern to the midpoint of its intended bucket. For example, the pattern for seven is mapped to 0.75. Stating at line 140, we have the patterns for the 7 to 10 neural network. The patterns are the same as before but notice the nice identity matrix look of the labels. That's how one hot encoding looks like. No pun intended. Finally, starting at line 156, we have the simplistic dataset for the seven to seven neural network. Again, at first glance, it looks silly to assign the same input values to the outputs. But I actually find it very interesting. You'll see why in the next videos. This shouldn't take you much longer than 15 minutes. So go train that network and come back to see my text-based solution, followed by three demo programs with a hopefully nice GUI.


Solution: Train your own SDR neural network
(upbeat music) - Let's see my solution. This program will train each of the three systems and then it will read an array of seven floats from the terminal to show us the outputs. In line 121, we are obtaining the number of epochs from the user. Then we initialize mlp1 as the seven to one system, mlp2 as the seven to ten system and mlp3 as the seven to seven system. Next, we have the provided training code for mlp1 then for mlp2, and for mlp3. Then starting at line 176, we have a loop where the input pattern is read from the terminal. The array must be entered as a series of exactly seven values corresponding to the segments A, B, C, D, E, F, and G all separated by spaces. When a negative value is entered, the program ends. So the body of the loop prints an interpreted version of the output for each system. Look at line 182 for the output of the seven to one system. Notice that I'm multiplying the neural networks output by 10 and then printing the truncated version of that number. That is an integer between zero and nine. In line 185, we have the output of the one hot encoded seven to 10 system. Here I'm printing the index of the highest value in the network's output. This is easily achieved with the arg max function. And for the seven to seven system in line 188, I'm printing around that version of the output array. So, we will only see zeros and ones. Let's see it all working. First, we are asked for the number of epochs to train the neural networks. Let me enter 3000. Now, we wait. Remember that each system is being trained for thousands of epochs, so this will take a while. Now, we get to enter patterns to the three neural networks. Let's start with an easy one. The pattern for number one is 0110000. There you have it, the seven to one network recognized number one. The seven to 10 system recognized one as well, and the seven to seven system outputs the same input pattern. Let's see it again with a pattern that's not in the training set. I'll enter a variation of number seven. That is three ones followed by four zeros, but I'll enter nearly ones and nearly zeros instead. Like this. And there you have it, all three systems recognized number seven. Now, let's deviate a bit more. As you can see, they are all recognizing number seven. Feel free to try different patterns and tweak the code. I understand if you are not having much fun with this example, this is a visual system so a GUI application is more appropriate, and that's what we are going to see in the next videos.