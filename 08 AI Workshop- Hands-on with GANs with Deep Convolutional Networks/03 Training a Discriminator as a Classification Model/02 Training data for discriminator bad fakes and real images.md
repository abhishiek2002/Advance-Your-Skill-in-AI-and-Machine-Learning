Training data for discriminator bad fakes and real images
Before we actually train a deep convolutional generative adversarial network, in this demo, we'll work with the discriminator alone. Remember, the discriminator component in a GAN is a simple classification model. We'll see how we can train that model on fake images and real images that I have previously generated. Once we see how the discriminator works standalone, we'll see the discriminator and the generator work together in a generative adversarial network. The data that I'm going to be using to train my discriminator is stored here on Google Drive. Within Google Drive, I have a folder called ai_workshop_dcgans. Here I've created a subfolder called anime_classification. I'm now going to click through to the subfolder and here you'll find two more subfolders; real_images and bad_fake _images. The real_images folder here contains real images from our training data. The bad_fake_images are fake images generated from a generative adversarial network that I had previously trained. But these are bad fakes because these are the outputs of the generator early on in the training. So they are very clearly identifiable as fake. Let's take a look at a few samples of the real images. First, let me open up this particular image and you can see this is an image of anime faces. I suggest you explore a few more of the real images here, and you can see that the image quality is pretty good. This is what we'll finally train our deep convolutional GAN to generate. And all of these images are multichannel or color images. Now let's go back and take a look at the bad_fake_images. The bad_fake_images have a name which includes the epoch of training the GAN was in when the image was generated. For example, an im_5 image was generated in the fifth epoch of training, and you can see that this image is pretty terrible. Many of the images generated early on during GAN training are going to be pretty bad. But if you look at images a little later on in the GAN training, they'll be better, but they are still pretty terrible fakes. The bad fake images that I have generated are from the first few epochs of training. So I'm going to sort, and here are some images from epoch 20. This is from a previously trained GAN, and you can see that they are better than images in epoch 5, but they are still pretty terrible. Our discriminator is going to have no trouble at all telling apart the fake images from the real anime faces in the dataset. And that's what we'll observe first. We'll be training our discriminator in Google Colab. So let's get set up with a Colab notebook. And this Colab notebook will train only the discriminator. So I'm going to call it TrainingDiscriminatorOnBad FakesAndRealImages. Because we're going to be using a discriminator with strided convolutional layers, let's ensure that we are using the GPU runtime. Notice my runtime here says T4 GPU. This is freely available for you to use, provided you don't go beyond a certain limit. Now in Google Colab, PyTorch is installed by default. Let's import all of the PyTorch libraries that we'll be using to train our discriminator. We need torch.nn to set up our neural network, torch.optim to set up the optimizer to train our model, torchvision.datasets to set up containers that will hold our training data transforms to apply transformations to the input images. And then, of course, the torchvision library, which has a number of vision-related utilities. The first thing we have to do is access our training data, which is on Google Drive. And you can do that using the drive object. drive.mount will mount the Google Drive associated with your currently logged in Google account, and make it available within Colab. You'll need to connect and authenticate yourself to Google Drive using your Google username and password. Make sure you allow Colab to access the contents of your Google Drive folder, and in a few moments, your Google Drive has been mounted at this location, /content/drive. If you open up the folder on the left navigation pane, you should find My Drive in there. That's essentially the home folder for your Google Drive. Now we shall be able to access content on drive from Colab.