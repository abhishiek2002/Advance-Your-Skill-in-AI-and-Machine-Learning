Viewing GAN training results
We set up the code for the training loop. All we have to do is run this code and let's see how our GAN performs. Now here we are in the very first epoch, epoch 0. This is where the results are completely random, both the generator and discriminator weights are completely untrained. Now let's iterate through a few epochs and then take a look at how these perform. The next output will be at around 200 batches of training. We are still on epoch 0, though you can't really see the epoch there. If you look at the generated images now, you can no longer call them complete noise. The generator has improved tremendously with just 200 iterations of training, but it's still pretty bad. The discriminator's total loss is 0.412. It's still low. The generator loss is 7.63, quite high. The real score of the discriminator is close to one, the fake score is close to zero, indicating the discriminator is doing a good job. The fake score after discriminator update is also close to zero, so the discriminator is clearly better at this point in time. Let's wait for a few more batches of training. Training will run rather slowly. The entire training took about 30 to 40 minutes on the GPU. Here we are on epoch 0, step 600. Notice the discriminator's loss, 0.523. It's gone up just a bit. The generator's loss still seems to be around the same, 7.788. The discriminator is still doing well. The real score is close to one, fake score close to zero, and the fake score after discriminator update also very close to zero. The images generated are getting better, but still, they are not great. Let's train for some more time and you can see that the images are gradually improving. Let's run training for some more time, and let's look at an output at epoch2, step 600. Notice the discriminator loss is going up, 0.619 now, generator loss is going down, 4.6. If you observe the generated images at the bottom, they look pretty good, and you can see that the real score for the discriminator is coming down, it's 0.654. The discriminator is finding it harder to identify real images. Both fake scores are still close to zero. I'll let this run for some more time, and you can marvel at the quality of images produced by the generator as training continues. Let's head over to epoch 8, step 600. The images at the bottom are pretty good quality. The discriminator and generator losses seem unusually high, but let's look at the score. Notice the fake score of the discriminator, it's getting closer to one. The discriminator is finding it harder to differentiate fake images from real ones. Well, I'll now let training continue till the very end. And if you look at the last batch of generated images, after training is complete, you can see that those images look pretty realistic. The generator started by generating complete noise, but it has rarely improved during the course of training. Now let's visualize the generator and discriminator losses over the course of training, and also the accuracy score of the discriminator on the real and fake data. Now this visualization isn't that great. That's because there is so much noise here for each iteration of training that you can't really see what's going on. But overall, as the generator improves, the generator's losses fall, discriminator's losses increase. The discriminator starts off with a very high accuracy on real and fake data, and this accuracy falls over time till it gets close to 50 percent. Unfortunately, the noise involved in the individual iterations really obscure this bit of information. One thing to keep in mind that there is no way to identify convergence for GAN training. As the generator steadily improves, the discriminator gets worse at identifying real images from fake. But as the discriminator gets worse, the discriminator starts predicting things randomly, and this causes the generator to get worse. So you should train a GAN till the generator improves the quality of its images, but at some point the generator will start getting worse because of the worse feedback it gets from the discriminator. Just something to keep in mind, when I tried training this GAN for 70 or 80 epochs, well, I felt the generated images got far worse.