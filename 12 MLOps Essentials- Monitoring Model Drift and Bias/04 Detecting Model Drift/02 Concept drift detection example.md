Concept drift detection example
- [Instructor] Let's now explore concept drift with an example. In this example, we will simulate concept drift for the model, and then analyze changes in feature target relationships. The code for this chapter is in the code_03_XX Drift Detection Example Python notebook. Let's load the notebook now. We will first install all the dependency packages for this chapter. These exercises need pandas, scikit-learn, and alibi-detect packages. We have training data available in the file credit-approval-training-data.csv. We load this file. The data contains information about credit card applications and whether they are approved or not. There are four feature variables, namely age range, income category, race, and credit rating. To keep things simple, all four of them are converted into categorical features. There are three classes in age range, four in income category, five in race, and six in credit rating. The target is the approved Boolean variable. To train this model, we first split the features and the target as train and test sets. We then proceed to build a Naive Bayes model using scikit-learn. We then check the classifier accuracy. It's about 93%. Then, we have production live data captured in the credit-approval-prod-data.csv. This also has the ground truth label for the approved flag. We use the credit approval model to credit approvals for the production data. Then, we compute the accuracy of these predictions using the ground truth. This comes to 38%, so there is a significant change in the overall predictions performance from 92% to 38%. This is considered concept drift. To explore the root cause, let's now do a correlation analysis between the target and the features. We do it for both the training data and the production data and compare the changes. We see that there is a significant change in age range and credit rating. This means there are changes in the real world where age and credit ratings are being treated differently than what was available in the training data to approve a loan. Now, the model requires retraining with the new data captured.