Viewing training data
In the previous movie, we instantiated a DataLoader over our Fashion-MNIST data. Let's see how we can iterate over this DataLoader. I instantiate an iterator on Line 1 and invoke the next function on the iterator, and that will give me the first batch of images and labels. If you remember, we specified a batch size of 16. Let's take a look at the shape of the tensors that make up the images and labels. The images shape is interesting. We look at that first. You can see it's 16, 1, 28 by 28. The first dimension in the images shape 16 refers to the size of the batch. The remaining three values 1, 28, and 28, refer to the dimensions of each image in a batch. One is the number of channels for the image. Remember, these are grayscale images. Every channel is a single-pixel with an intensity value. And 28 by 28, those are the heights and widths of the Fashion-MNIST images. In addition to the 16 images in a batch, we have the labels corresponding to those images. We won't really be using the labels in our GAN training, but you should know that they are available. Let's visualize and understand the data that we are working with. Here are the 10 classes into which the images are categorized. You can see that each class represents a fashion accessory. In order to view the images in our training data, I'm going to set up a utility function called display. Display takes in a single image tensor as an input. If you remember, when we had loaded in the dataset, we had normalized each image by subtracting 0.5 from the pixel values and dividing by 0.5. This unnormalized operation that you see on Line 8 is simply the reverse. Here we perform the reverse operation of a normalization. We multiply by 0.5, which is the same as dividing by two, and add 0.5. Now, let me explain the need for the code on Line 10. Image tensors in PyTorch are represented using the following dimensions. The number of channels come first and then the height and width of images. The matplotlib library, which is what we'll use to display these images, expects that height comes first, then width, and then number of channels. So this img.permute function swaps the dimensions of the PyTorch tensors so that they are in the format that matplotlib will accept; height, width, and then number of channels. On Line 12, we convert from PyTorch tensors to NumPy arrays, and on Line 14 through 17, we display the image on screen. Now, let's use this display function and take a look at the images that we are working with. Make_grid is a utility available in PyTorch, which takes the images that you pass in and arranges them in a grid format. The four that I have specified as an input argument indicates that they should be four columns in the grid and the images are one batch of images and right below the images, I print out the class labels. Let's take a look at what our image data looks like. And here is the first batch of images from our training data. Notice we have pullovers. We have sandals. We have sneakers. We have trousers, dresses. We'll train our GAN using these images and get our GAN to generate images of this kind.